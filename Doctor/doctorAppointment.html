<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Doctor Appointments</title>
    <link rel="stylesheet" href="https://maxst.icons8.com/vue-static/landings/line-awesome/line-awesome/1.3.0/css/line-awesome.min.css">
    <link rel="stylesheet" href="dashboardStyle.css">
    <link rel="stylesheet" href="appointmentStyle.css">
    <script src="../assets/js/StorageManager.js"></script>
    <script src="appointmentScript.js" defer></script>
</head>

<body>
    <input type="checkbox" id="nav-toggle">
    <div class="sidebar">
        <div class="sidebar-brand">
            <div class="brand-flex">
                <img src="img/logo.png" width="50px" alt="logo">
                <div class="brand-icons">
                    <span class="las la-bell"></span>
                    <span class="las la-user-circle"></span>
                </div>
            </div>
        </div>
        <div class="sidebar-main">
            <div class="sidebar-doctor">
                <div class="doctor-profile">
                    <img src="img/doctor.jpg" alt="doctor">
                    <div class="doctor-info">
                        <h2>Hassan Yassin</h2>
                        <p>doc.hassanyassin@gmail.com</p>
                    </div>
                </div>
            </div>
            <div class="sidebar-menu">
                <div class="menu-block">
                    <div class="menu-head">
                        <span>Dashboard</span>
                    </div>
                    <ul>
                        <li>
                            <a href="dashboard.html">
                                <span class="las la-tachometer-alt"></span>
                                <span>Overview</span>
                            </a>
                        </li>
                        <li>
                            <a href="doctorAppointment.html" class="active">
                                <span class="las la-calendar-check"></span>
                                <span>Appointments</span>
                            </a>
                        </li>
                        <li>
                            <a href="doctorPatients.html">
                                <span class="las la-user-md"></span>
                                <span>Patients</span>
                            </a>
                        </li>
                        <li>
                            <a href="doctorChat.html">
                                <span class="las la-comments"></span>
                                <span>Chats</span>
                            </a>
                        </li>
                        <li>
                            <a href="#" id="logoutBtn">
                                <span class="las la-sign-out-alt"></span>
                                <span>Logout</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <div class="main-content">
        <header>
            <div class="menu-toggle">
                <label for="nav-toggle">
                    <span class="las la-bars"></span>
                </label>
            </div>
            <div class="search-wrapper">
                <span class="las la-search"></span>
                <input type="search" placeholder="Search appointments">
            </div>
            <div class="header-icons">
                <span class="las la-bookmark"></span>
                <span class="las la-sms"></span>
            </div>
        </header>
        <main>
            <div class="page-header">
                <div>
                    <h1>Appointments</h1>
                    <small>Manage and schedule appointments</small>
                </div>
                <div class="header-actions">
                    <button class="filter-btn">
                        <span class="las la-filter"></span>
                        Filter
                    </button>
                    <button class="export-btn">
                        <span class="las la-file-export"></span>
                        Export
                    </button>
                </div>
            </div>

            <div class="appointments-grid">
                <div class="appointments-section">
                    <div class="card">
                        <div class="card-header">
                            <h3>Today's Appointments</h3>
                            <div class="card-header-actions">
                                <button class="filter-btn">
                                    <span class="las la-filter"></span>
                                    Filter
                                </button>
                                <button class="export-btn">
                                    <span class="las la-file-export"></span>
                                    Export
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <table class="appointments-table">
                                <thead>
                                    <tr>
                                        <th>Patient Info</th>
                                        <th>Date</th>
                                        <th>Time</th>
                                        <th>Type</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="appointmentTableBody">
                                    <tr>
                                        <td class="patient-info">
                                            <img src="img/patient1.jpg" alt="John Smith">
                                            <div>
                                                <h4>John Smith</h4>
                                                <small>ID: P-0123</small>
                                            </div>
                                        </td>
                                        <td>Mar 15, 2024</td>
                                        <td>10:00 AM</td>
                                        <td>Check-up</td>
                                        <td><span class="status confirmed">Confirmed</span></td>
                                        <td class="actions">
                                            <button class="action-btn view-btn" data-appointment-id="APT-001">
                                                <span class="las la-eye"></span>
                                            </button>
                                            <button class="action-btn edit-btn" data-appointment-id="APT-001">
                                                <span class="las la-edit"></span>
                                            </button>
                                            <button class="action-btn delete-btn" data-appointment-id="APT-001">
                                                <span class="las la-trash"></span>
                                            </button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="patient-info">
                                            <img src="img/patient2.jpg" alt="Sarah Johnson">
                                            <div>
                                                <h4>Sarah Johnson</h4>
                                                <small>ID: P-0124</small>
                                            </div>
                                        </td>
                                        <td>Mar 15, 2024</td>
                                        <td>11:30 AM</td>
                                        <td>Consultation</td>
                                        <td><span class="status pending">Pending</span></td>
                                        <td class="actions">
                                            <button class="action-btn view-btn" data-appointment-id="APT-002">
                                                <span class="las la-eye"></span>
                                            </button>
                                            <button class="action-btn edit-btn" data-appointment-id="APT-002">
                                                <span class="las la-edit"></span>
                                            </button>
                                            <button class="action-btn delete-btn" data-appointment-id="APT-002">
                                                <span class="las la-trash"></span>
                                            </button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Appointment Details Modal -->
            <div id="appointmentModal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2>Appointment Details</h2>
                        <span class="close-modal">&times;</span>
                    </div>
                    <div class="modal-body">
                        <div class="appointment-details-grid">
                            <div class="detail-group">
                                <label>Patient Name</label>
                                <p id="modalPatientName"></p>
                            </div>
                            <div class="detail-group">
                                <label>Patient ID</label>
                                <p id="modalPatientId"></p>
                            </div>
                            <div class="detail-group">
                                <label>Date</label>
                                <p id="modalDate"></p>
                            </div>
                            <div class="detail-group">
                                <label>Time</label>
                                <p id="modalTime"></p>
                            </div>
                            <div class="detail-group">
                                <label>Type</label>
                                <p id="modalType"></p>
                            </div>
                            <div class="detail-group">
                                <label>Status</label>
                                <p id="modalStatus"></p>
                            </div>
                            <div class="detail-group full-width">
                                <label>Notes</label>
                                <p id="modalNotes"></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- New/Edit Appointment Modal -->
            <div id="newAppointmentModal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2>Schedule New Appointment</h2>
                        <span class="close-modal">&times;</span>
                    </div>
                    <form id="appointmentForm">
                        <div class="form-group">
                            <label for="patientSelect">Patient</label>
                            <select id="patientSelect" name="patientId" required>
                                <option value="">Select Patient</option>
                                <option value="P-0123">John Smith (P-0123)</option>
                                <option value="P-0124">Sarah Johnson (P-0124)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="appointmentDate">Date</label>
                            <input type="date" id="appointmentDate" name="date" required>
                        </div>
                        <div class="form-group">
                            <label for="appointmentTime">Time</label>
                            <input type="time" id="appointmentTime" name="time" required min="09:00" max="17:00">
                            <small>Available hours: 9:00 AM - 5:00 PM</small>
                        </div>
                        <div class="form-group">
                            <label for="appointmentType">Type</label>
                            <select id="appointmentType" name="type" required>
                                <option value="">Select Type</option>
                                <option value="Check-up">Check-up</option>
                                <option value="Consultation">Consultation</option>
                                <option value="Follow-up">Follow-up</option>
                                <option value="Emergency">Emergency</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="appointmentStatus">Status</label>
                            <select id="appointmentStatus" name="status" required>
                                <option value="pending">Pending</option>
                                <option value="confirmed">Confirmed</option>
                                <option value="cancelled">Cancelled</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="appointmentNotes">Notes</label>
                            <textarea id="appointmentNotes" name="notes" rows="3"></textarea>
                        </div>
                        <div class="form-actions">
                            <button type="submit" class="save-btn">Save Appointment</button>
                            <button type="button" class="cancel-btn">Cancel</button>
                        </div>
                    </form>
                </div>
            </div>
        </main>
    </div>
    <script>
        // Initialize the appointment manager
        var appointmentManager = new AppointmentManager();

        // Add logout functionality
        document.getElementById('logoutBtn').addEventListener('click', function(e) {
            e.preventDefault();
            // Clear any session data if needed
            sessionStorage.clear();
            localStorage.clear();
            // Redirect to login page
            window.location.href = '../Login Page/login.html';
        });

        // Initialize filter and export buttons
        document.addEventListener('DOMContentLoaded', function() {
            // Filter buttons
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', () => appointmentManager.openFilterModal());
            });

            // Export buttons
            document.querySelectorAll('.export-btn').forEach(btn => {
                btn.addEventListener('click', () => appointmentManager.exportAppointments());
            });

            // Load initial appointments
            appointmentManager.loadAppointments();
        });
    </script>
</body>
</html>
